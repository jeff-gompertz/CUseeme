<!-- === CUCME Emulation v1.3_interactivepulse === -->
<!-- Change summary: adds generative gray text echoes triggered by user input -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>CUCME Emulation v1.3 â€” Interactive Pulse</title>

<style>
html,body{
  margin:0;padding:0;height:100%;
  background:#fff;overflow:hidden;
  font-family:system-ui, monospace;
}

/* Fullscreen live camera */
#mirror{
  position:fixed;inset:0;
  width:100%;height:100%;
  object-fit:cover;
  z-index:0;
  filter:brightness(1.05) contrast(1.05);
}

/* Subtle white gradient overlay */
#overlay{
  position:fixed;inset:0;
  background:linear-gradient(to bottom,
    rgba(255,255,255,0.18) 0%,
    rgba(255,255,255,0.02) 40%,
    rgba(255,255,255,0.18) 100%);
  z-index:1;
  pointer-events:none;
  mix-blend-mode:screen;
}

/* Prompt input */
#promptWrap{
  position:fixed;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  z-index:2;
  background:rgba(255,255,255,0.25);
  backdrop-filter:blur(6px);
  border:none;border-radius:25px;
  padding:0.8rem 1.5rem;
  width:260px;
  box-shadow:0 0 12px rgba(255,255,255,0.3);
  display:flex;
  align-items:center;
  justify-content:flex-start;
}

/* Input field */
#input{
  border:none;outline:none;
  background:transparent;
  color:#111;
  font-size:1rem;width:100%;
  font-family:inherit;
  text-align:left;
  caret-color:transparent; /* hide default caret */
}

/* Thinner left-hand blinking cursor */
#cursor{
  width:0.25ch;height:1em;
  background:#fff;
  margin-right:0.2rem;
  animation:blink 1s step-end infinite;
}
@keyframes blink{50%{opacity:0}}

/* Echo field */
#echoes{
  position:fixed;
  inset:0;
  z-index:3;
  pointer-events:none;
  overflow:hidden;
}
.echo{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  color:rgba(0,0,0,0.25);
  font-size:1.4rem;
  animation:floatUp 8s ease-out forwards;
  white-space:nowrap;
}
@keyframes floatUp{
  0%{opacity:0;transform:translate(-50%,30px) scale(1)}
  10%{opacity:1}
  90%{opacity:0.6;transform:translate(-50%,-120px) scale(1.05)}
  100%{opacity:0;transform:translate(-50%,-160px) scale(1.1)}
}

/* Permission message */
#notice{
  position:fixed;inset:0;
  display:grid;place-items:center;
  background:rgba(255,255,255,0.9);
  z-index:5;
  font-size:1.2rem;
  color:#333;
}
</style>
</head>
<body>

<video id="mirror" autoplay playsinline muted></video>
<div id="overlay"></div>

<div id="promptWrap">
  <div id="cursor"></div>
  <input id="input" type="text" />
</div>

<div id="echoes"></div>
<div id="notice">Allow camera to activate field?</div>

<script>
(async () => {
  const video = document.getElementById('mirror');
  const notice = document.getElementById('notice');
  const input = document.getElementById('input');
  const echoes = document.getElementById('echoes');

  // --- camera permission ---
  try {
    const stream = await navigator.mediaDevices.getUserMedia({ video:true, audio:false });
    video.srcObject = stream;
    notice.style.display = 'none';
  } catch (err) {
    notice.textContent = 'Camera access denied or unavailable.';
    console.warn('Camera error:', err);
  }

  // --- echo generator ---
  function emitEcho(text){
    if(!text) return;
    const el = document.createElement('div');
    el.className='echo';
    el.textContent=text;
    el.style.top = `${50 + (Math.random()*40 - 20)}%`;
    echoes.appendChild(el);
    setTimeout(()=>el.remove(), 8000);
  }

  // --- reactive typing ---
  input.addEventListener('input', (e)=>{
    const val = e.target.value.trim();
    if(val && Math.random() < 0.2){ // emit occasionally while typing
      emitEcho(val);
    }
  });

  // --- enter key pulse ---
  input.addEventListener('keydown', (e)=>{
    if(e.key==='Enter'){
      const val = e.target.value.trim();
      if(!val) return;
      emitEcho(val);
      input.value='';
    }
  });
})();
</script>

</body>
</html>
