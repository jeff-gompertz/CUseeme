<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Database Recursion — Stage 1 (Final Visible)</title>
<style>
  html,body{
    margin:0;padding:0;overflow:hidden;
    background:#ffffff;color:#000000;height:100%;
    font-family:Helvetica,Arial,sans-serif;
  }
  canvas{
    position:fixed;inset:0;width:100%;height:100%;z-index:-2;
  }
  #text-feed{
    position:fixed;bottom:0;width:100%;height:100%;
    display:flex;justify-content:center;align-items:flex-end;
    overflow:hidden;z-index:-1;color:#000;
  }
  #feed-content{
    text-align:center;width:80%;
    font-size:1.5rem;line-height:2rem;
  }
  .headline{margin:1rem 0;}
</style>
</head>
<body>
<canvas id="trail"></canvas>
<div id="text-feed"><div id="feed-content"></div></div>

<script>
window.addEventListener("load", () => {

  /* === visible motion field === */
  const canvas=document.getElementById("trail");
  const ctx=canvas.getContext("2d");
  let W=innerWidth,H=innerHeight;
  canvas.width=W;canvas.height=H;
  addEventListener("resize",()=>{W=innerWidth;H=innerHeight;canvas.width=W;canvas.height=H;});
  let t=0;
  function draw(){
    t+=0.02;
    ctx.fillStyle="rgba(255,255,255,0.2)";
    ctx.fillRect(0,0,W,H);
    const hue=200+150*Math.sin(t);
    const r=80+60*Math.sin(t*2);
    ctx.beginPath();
    ctx.arc(W/2,H/2,r,0,Math.PI*2);
    ctx.fillStyle=`hsla(${hue},100%,60%,0.3)`;
    ctx.fill();
    requestAnimationFrame(draw);
  }
  draw();

  /* === Local fallback text (always visible) === */
  const localLines=[
    "Database Recursion — confirmed visible baseline",
    "If you can read this, text layer is active",
    "White background ensures visual contrast",
    "Next step: re-enable live RSS feed",
    "Canvas feedback confirmed below"
  ];

  buildFeed(localLines);

  function buildFeed(lines){
    const feed=document.getElementById("feed-content");
    feed.innerHTML="";
    lines.forEach(line=>{
      const d=document.createElement("div");
      d.className="headline";
      d.textContent=line;
      feed.appendChild(d);
    });
    startScroll();
  }

  function startScroll(){
    const content=document.getElementById("feed-content");
    let y=H*0.9;
    content.style.transform=`translateY(${y}px)`;
    function animate(){
      y-=1;
      content.style.transform=`translateY(${y}px)`;
      if(y+content.offsetHeight>0){
        requestAnimationFrame(animate);
      }else{
        y=H*0.9;
        requestAnimationFrame(animate);
      }
    }
    animate();
  }

});
</script>
</body>
</html>
