<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>CUSeeMe Emulation v1.7.2 — Camera + Voice Stable</title>
<style>
html,body{
  margin:0;padding:0;height:100%;overflow:hidden;
  background:#fff;font-family:monospace;color:#0f0;
}
#camera{
  position:fixed;inset:0;object-fit:cover;
  transform:scaleX(-1);
  z-index:0;
  filter:brightness(1.05) contrast(1.05);
}
#promptWrap{
  position:fixed;inset:0;display:flex;
  align-items:center;justify-content:center;
  z-index:2;pointer-events:none;
}
#promptBox{
  pointer-events:auto;
  background:rgba(255,255,255,0.25);
  border:1px solid rgba(0,0,0,0.2);
  border-radius:10px;
  padding:.6rem 1rem;
  font-size:2rem;
  display:flex;align-items:center;gap:.4rem;
}
#input{
  background:transparent;
  border:none;outline:none;
  color:#111;
  font-size:inherit;
  width:14ch;
}
#caret{
  width:.25ch;height:1.3em;background:#111;
  animation:blink 1s step-end infinite;
}
@keyframes blink{50%{opacity:0}}
#ticker{
  position:fixed;
  left:10px;bottom:10px;
  width:40%;
  max-height:50%;
  display:flex;flex-direction:column-reverse;
  overflow:hidden;
  z-index:3;
  font-size:1rem;line-height:1.2rem;
  color:#0f0;opacity:.9;
}
.tline{
  opacity:.8;margin:0;
  animation:fadeIn 1s ease forwards;
  transition:opacity 45s linear;
}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:.8;transform:translateY(0)}
}
#overlay{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  background:rgba(255,255,255,0.9);
  color:#111;
  font-size:1.5rem;
  z-index:5;
}
</style>
</head>
<body>
<video id="camera" autoplay muted playsinline></video>

<div id="promptWrap">
  <div id="promptBox">
    <div id="caret"></div>
    <input id="input" type="text" spellcheck="false" autocomplete="off" placeholder="type here...">
  </div>
</div>

<div id="ticker"></div>
<div id="overlay">Tap to activate camera + audio</div>

<script>
(async()=>{
  const cam=document.getElementById('camera');
  const overlay=document.getElementById('overlay');
  const ticker=document.getElementById('ticker');
  const input=document.getElementById('input');

  function addTickerLine(text){
    const el=document.createElement('div');
    el.className='tline';
    el.textContent=text;
    ticker.prepend(el);
    if(ticker.children.length>40)ticker.removeChild(ticker.lastChild);
    setTimeout(()=>{el.style.opacity=0.15;},45000);
  }

  // --- stable speech setup ---
  let voicesReady=false;
  function waitForVoices(){
    return new Promise(resolve=>{
      if(voicesReady && speechSynthesis.getVoices().length)return resolve();
      const id=setInterval(()=>{
        if(speechSynthesis.getVoices().length){
          clearInterval(id);voicesReady=true;resolve();
        }
      },100);
    });
  }
  async function speak(text){
    if(!('speechSynthesis'in window))return;
    await waitForVoices();
    const u=new SpeechSynthesisUtterance(text);
    u.rate=1.05;u.pitch=0.9;u.volume=0.8;u.lang='en-US';
    const v=speechSynthesis.getVoices();
    u.voice=v.find(x=>/samantha/i.test(x.name))||
            v.find(x=>/google/i.test(x.name))||v[0];
    speechSynthesis.speak(u);
  }

  // --- on first tap: unlock camera + audio ---
  overlay.addEventListener('click', async ()=>{
    overlay.remove();
    try{
      const stream=await navigator.mediaDevices.getUserMedia({video:true,audio:false});
      cam.srcObject=stream;
      addTickerLine("🎥 camera stream active");
    }catch(e){
      addTickerLine("⚠️ camera denied: "+e.message);
      alert('Camera access denied');
    }
    // trigger speech engine
    speechSynthesis.speak(new SpeechSynthesisUtterance(''));
  }, {once:true});

  // --- diagnostics ---
  const diagnostics=[
    "calibrating optical link...",
    "signal noise threshold: 0.72",
    "frame drift compensated",
    "latency ping: 54ms",
    "loopback handshake OK",
    "resonance echo stable",
    "stream integrity: 99.3%",
    "field synchronization nominal"
  ];
  setInterval(()=>{
    const msg=diagnostics[Math.floor(Math.random()*diagnostics.length)];
    addTickerLine(msg);
  },6500);

  // --- input handler ---
  input.addEventListener('keydown',e=>{
    if(e.key!=='Enter')return;
    const val=input.value.trim();
    if(!val)return;
    addTickerLine('> '+val);
    input.value='';
    const replies=[
      `system echo: "${val}" acknowledged`,
      `field response latency: ${(Math.random()*0.8+0.2).toFixed(2)} s`,
      `semantic drift detected in "${val}"`,
      `resonance pattern: ${Math.floor(Math.random()*100)}% correlation`,
      `"${val}" logged in memory bank`
    ];
    const reply=replies[(Math.random()*replies.length)|0];
    setTimeout(()=>{
      addTickerLine('< '+reply);
      speak(reply);
    },600);
  });
})();
</script>
</body>
</html>
