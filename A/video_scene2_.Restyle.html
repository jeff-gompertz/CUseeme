<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>CUSeeMe ‚Äî Scene 2 (Return + Full Logic)</title>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v6.0.0-beta1/css/all.css">

<style>
html,body {
  margin: 0;
  height: 100%;
  background: #e5e9f4;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
  font-family: system-ui, sans-serif;
}

/* =========================================================
Header ‚Äî neumorphic row from Scene 1
========================================================= */
header {
  position: fixed;
  top: 0; left: 0;
  width: 100%;
  background: #e5e9f4;
  box-shadow: 0 5px 10px rgba(0,0,0,0.05);
  z-index: 1000;
  display: flex;
  justify-content: center;
  padding: 1rem 0;
}
.buttons {
  display: grid;
  grid-template-columns: repeat(6, minmax(60px, 1fr));
  gap: 1rem;
  width: min(90vw, 500px);
}
button.neumorphic {
  border: 0.5rem solid transparent;
  border-radius: 1rem;
  color: hsl(0 0% 10%);
  background: none;
  display: grid;
  place-content: center;
  gap: 0.5rem;
  --shadow:
    -.5rem -.5rem 1rem hsl(0 0% 100% / .75),
    .5rem .5rem 1rem hsl(0 0% 50% / .5);
  box-shadow: var(--shadow);
  outline: none;
  transition: all 0.1s;
}
button.neumorphic:hover,
button.neumorphic:focus-visible {
  color: hsl(10 80% 50%);
  scale: 1.05;
}
button.neumorphic:active,
button.neumorphic.active {
  box-shadow:
    var(--shadow),
    inset .5rem .5rem 1rem hsl(0 0% 50% / .5),
    inset -.5rem -.5rem 1rem hsl(0 0% 100% / .75);
  color: hsl(10 80% 50%);
}
button.neumorphic > i { font-size: 20px; }
button.neumorphic > span { font-size: 12px; }

@media (max-width: 600px) {
  .buttons {
    grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
    width: 95vw;
    gap: 0.5rem;
  }
  button.neumorphic > i { font-size: 16px; }
  button.neumorphic > span { font-size: 10px; }
}

/* =========================================================
Main area ‚Äî wraps your CUSeeMe layers below header
========================================================= */
main {
  flex: 1;
  width: 100%;
  padding-top: 110px; /* offset header */
  position: relative;
  overflow: hidden;
}

/* Retain original HUD, ticker, etc. */
:root {
  --hud-glass: rgba(185,225,255,0.45);
  --hud-border-light: rgba(255,255,255,0.65);
  --hud-border-dark: rgba(0,45,90,0.35);
  --hud-shadow: 0 12px 45px rgba(0,50,90,0.35);
  --hud-text: #1b1d22;
  --btn-bg: rgba(215,235,255,0.35);
  --btn-inset-light: rgba(255,255,255,0.8);
  --btn-inset-dark: rgba(0,30,60,0.3);
  --btn-glow: rgba(255,120,50,0.7);
  --btn-glow-outer: rgba(255,150,80,0.35);
  --ticker: #ff3a2f;
}

#cameraMain {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: scaleX(-1);
  z-index: 100;
}

/* HUD wrapper (from original Scene 2) */
#hudShell {
  position: fixed;
  top: 140px;
  right: 32px;
  z-index: 200;
  display: grid;
  gap: 14px;
  padding: 28px 26px 26px;
  min-width: 320px;
  background: var(--hud-glass);
  border-radius: 20px;
  border: 1px solid var(--hud-border-light);
  box-shadow:
    inset 0 1px 3px var(--hud-border-light),
    inset 0 -1px 3px var(--hud-border-dark),
    var(--hud-shadow);
  backdrop-filter: blur(20px) saturate(1.25);
  -webkit-backdrop-filter: blur(20px) saturate(1.25);
  color: var(--hud-text);
  text-align: center;
}
#ticker {
  position: fixed;
  left: 16px;
  bottom: 14px;
  z-index: 900;
  width: 45vw;
  max-width: 700px;
  max-height: 50vh;
  display: flex;
  flex-direction: column-reverse;
  overflow: hidden;
  color: var(--ticker);
  font-size: 18px;
  line-height: 1.25;
}
.tline { opacity: .95; margin: 0; animation: fadeIn .6s ease; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: none } }

.miniWin {
  position: absolute;
  width: 22vw; max-width: 380px; aspect-ratio: 9/16;
  background: rgba(210,240,255,0.25);
  border: 1px solid rgba(255,255,255,0.55);
  border-radius: 16px;
  backdrop-filter: blur(12px);
  box-shadow:
    inset 0 1px 2px rgba(255,255,255,0.6),
    0 18px 40px rgba(0,0,0,0.25);
  overflow: hidden;
  cursor: grab;
  z-index: 500;
}
.miniWin:active { cursor: grabbing; }
.miniBar {
  display: flex; align-items: center; justify-content: space-between;
  padding: 4px 10px; height: 26px;
  background: rgba(255,255,255,0.18);
  font-size: 12px; color: #222; user-select: none;
}
.miniInner { position: relative; width: 100%; height: calc(100% - 26px); }
.miniVideo { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }


</style>
</head>

<body>

<!-- HEADER -->
<header>
  <div class="buttons">
    <button class="neumorphic"><i class="fa-light fa-fire"></i><span>Button 1</span></button>
    <button class="neumorphic"><i class="fa-light fa-dna"></i><span>Button 2</span></button>
    <button class="neumorphic"><i class="fa-light fa-chart-mixed"></i><span>Button 3</span></button>
    <button class="neumorphic"><i class="fa-light fa-atom"></i><span>Button 4</span></button>
    <button class="neumorphic"><i class="fa-light fa-seedling"></i><span>Button 5</span></button>
    <button class="neumorphic active"><i class="fa-light fa-arrow-left"></i><span>Return</span></button>
  </div>
</header>

<main>
  <!-- Keep your CUSeeMe layers intact -->
  <video id="cameraMain" autoplay muted playsinline></video>

  <div id="hudWrapper">
    <div id="hudIndex">HUD 1 / 2</div>
    <div id="hudShell">
      <div id="hudHeader">Mode &gt; Shift</div>

      <!-- HUD 1 -->
      <div id="hud1" class="hud-panel active">
        <div class="hud-row">
          <button class="hud-btn" id="btnSpawn5">‚ûï Spawn 5</button>
          <button class="hud-btn" id="btnReverseCam">üîÅ Reverse Cam</button>
        </div>
        <div class="hud-row">
          <button class="hud-btn" id="btnVoice">üîä Voice</button>
          <button class="hud-btn" id="btnCloseAll">‚úï Close All</button>
        </div>
      </div>

      <!-- HUD 2 -->
      <div id="hud2" class="hud-panel">
        <div class="hud-row">
          <button class="hud-btn">üì° Stream Status</button>
          <button class="hud-btn">üó∫ Network Map</button>
        </div>
        <div class="hud-row">
          <button class="hud-btn">üîß Diagnostics</button>
          <button class="hud-btn">‚Ü© Return</button>
        </div>
      </div>
    </div>
  </div>

  <div id="ticker"></div>
</main>

<!-- Keep all original logic from your working version -->
<script>
const ticker=document.getElementById('ticker');
function addTicker(txt){
  const line=document.createElement('div');
  line.className='tline';
  line.textContent=txt;
  ticker.prepend(line);
  if(ticker.children.length>80)ticker.removeChild(ticker.lastChild);
}
['index: v1.7 mode dynamic','retro4.4 aqua loaded','rear camera default','multi-HUD active']
.forEach((m,i)=>setTimeout(()=>addTicker(m),250*i));

let mediaStream=null;
let facing='environment';
async function initStream(){
  if(mediaStream){ mediaStream.getTracks().forEach(t=>t.stop()); mediaStream=null; }
  try{
    mediaStream=await navigator.mediaDevices.getUserMedia({
      video:{facingMode:{ideal:facing}}, audio:false
    });
    addTicker(`camera: ${facing==='user'?'front':'rear'} feed ready`);
  }catch(e){ addTicker('‚ö† camera denied/unavailable'); }
}

const btnSpawn5=document.getElementById('btnSpawn5');
const btnCloseAll=document.getElementById('btnCloseAll');
const btnReverseCam=document.getElementById('btnReverseCam');
const btnVoice=document.getElementById('btnVoice');
let voiceOn=false,voicesReady=false;
btnReverseCam.addEventListener('click',async()=>{
  facing=(facing==='user')?'environment':'user';
  await initStream();
});
btnSpawn5.addEventListener('click',()=>addTicker('spawn 5 placeholder'));
btnCloseAll.addEventListener('click',()=>addTicker('close all placeholder'));
btnVoice.addEventListener('click',()=>{
  voiceOn=!voiceOn;
  btnVoice.classList.toggle('active',voiceOn);
  addTicker(`voice: ${voiceOn?'enabled':'disabled'}`);
});
initStream();
</script>

  
/* =========================================================
Mini-window System (restored from v1.7 dynamic)
========================================================= */
<script>
/* =========================================================
Mini-Window System ‚Äî clean unified version (v1.7 dynamic)
========================================================= */
let winCount = 0, spawnUsed = false;

/* Create draggable mini camera window */
function makeMiniWindow({ x = 80, y = 80 } = {}) {
  winCount++;
  const el = document.createElement("div");
  el.className = "miniWin";
  el.style.left = x + "px";
  el.style.top = y + "px";
  el.innerHTML = `
    <div class="miniBar">
      <div class="miniTitle">subject_${String(winCount).padStart(4, "0")}</div>
      <div class="miniBtns">
        <div class="win-dot"></div><div class="win-dot"></div><div class="win-dot"></div>
      </div>
    </div>
    <div class="miniInner">
      <video class="miniVideo" autoplay muted playsinline></video>
    </div>
  `;
  document.body.appendChild(el);

  /* Connect video feed */
  const v = el.querySelector(".miniVideo");
  if (window.mediaStream) v.srcObject = mediaStream;

  /* Drag logic */
  const bar = el.querySelector(".miniBar");
  let dragging = false, sx = 0, sy = 0, sl = 0, st = 0;

  function start(e) {
    dragging = true;
    const r = el.getBoundingClientRect();
    sl = r.left; st = r.top;
    sx = (e.touches ? e.touches[0].clientX : e.clientX);
    sy = (e.touches ? e.touches[0].clientY : e.clientY);
    document.addEventListener("pointermove", move);
    document.addEventListener("pointerup", stop);
    document.addEventListener("touchmove", move, { passive: false });
    document.addEventListener("touchend", stop);
  }

  function move(e) {
    if (!dragging) return;
    const cx = (e.touches ? e.touches[0].clientX : e.clientX);
    const cy = (e.touches ? e.touches[0].clientY : e.clientY);
    el.style.left = sl + (cx - sx) + "px";
    el.style.top = st + (cy - sy) + "px";
    e.preventDefault?.();
  }

  function stop() {
    dragging = false;
    document.removeEventListener("pointermove", move);
    document.removeEventListener("pointerup", stop);
    document.removeEventListener("touchmove", move);
    document.removeEventListener("touchend", stop);
  }

  bar.addEventListener("pointerdown", start);
  bar.addEventListener("touchstart", start, { passive: false });

  return el;
}

/* ---------------------------------------------------------
HUD Button Wiring
--------------------------------------------------------- */
const btnSpawn5 = document.getElementById("btnSpawn5");
const btnCloseAll = document.getElementById("btnCloseAll");
const btnReverseCam = document.getElementById("btnReverseCam");

/* Spawn 5 mini windows */
btnSpawn5.addEventListener("click", () => {
  if (spawnUsed) return addTicker("spawn blocked: already active");
  spawnUsed = true;
  const startX = 60 + Math.random() * 40,
        startY = 120 + Math.random() * 40;
  for (let i = 0; i < 5; i++)
    makeMiniWindow({ x: startX + i * 26, y: startY + i * 18 });
  addTicker("spawned 5 windows");
});

/* Close all mini windows */
btnCloseAll.addEventListener("click", () => {
  document.querySelectorAll(".miniWin").forEach((n) => n.remove());
  winCount = 0;
  spawnUsed = false;
  addTicker("all windows closed");
});

/* Reverse camera feed */
btnReverseCam.addEventListener("click", async () => {
  window.facing = (facing === "user") ? "environment" : "user";
  await initStream();
  addTicker(`camera flipped ‚Üí ${facing}`);
});
</script>

<script>
/* =========================================================
Return Button Logic (Scene Switch)
========================================================= */
document.addEventListener("DOMContentLoaded", () => {
  const btnReturn = document.querySelectorAll(".neumorphic")[5];
  if (!btnReturn) return;
  btnReturn.addEventListener("click", () => {
    window.location.href =
      "https://jeff-gompertz.github.io/CUseeme/A/video_scene1_live_portrait2.html";
  });
});
</script>

<!-- Scene label -->
<div style="
  position:fixed;
  bottom:6px;
  right:10px;
  font-family:monospace;
  font-size:12px;
  opacity:0.6;
">Scene 2</div>

</body>
</html>
<div style="position:fixed;bottom:6px;right:10px;font-family:monospace;font-size:12px;opacity:0.6;">Scene 2</div>

  
  </body>
</html>
