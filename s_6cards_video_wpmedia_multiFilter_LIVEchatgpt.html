<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>6Cards — Live Camera Version</title>
  <style>
    body { margin: 0; overflow: hidden; background: black; }
    canvas { display: block; }
  </style>
</head>
<body data-livecam="true">
  <canvas id="c"></canvas>

  <script>
  const canvas = document.getElementById("c");
  const ctx = canvas.getContext("2d");

  function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener("resize", resize);
  resize();

  /* === Card / Panel Setup (identical to your originals) === */
  let cards = [];
  const NUM_CARDS = 12;
  const CENTER_OVERLAP = 120;
  const STAGGER_X = 40;

  function initCards(vids){
    const W = canvas.width, H = canvas.height;
    const w = W / 2, h = H;
    cards = [];

    for (let i = 0; i < NUM_CARDS; i++) {
      const side = i < NUM_CARDS / 2 ? "left" : "right";
      const inward = (Math.random() - 0.5) * STAGGER_X;
      const xBase = side === "left"
        ? CENTER_OVERLAP + inward
        : (W / 2) - CENTER_OVERLAP + inward;

      cards.push({
        x: xBase,
        y: (Math.random() - 0.5) * 50,
        w, h,
        vx: (Math.random() - 0.5) * 0.5,
        vy: (Math.random() - 0.5) * 0.5,
        side,
        vid: vids[i % vids.length]
      });
    }
  }

  function drawVideoCover(vid,x,y,w,h,a=1){
    if(!vid||vid.readyState<2) return;
    const iw=vid.videoWidth||vid.width, ih=vid.videoHeight||vid.height;
    const r=Math.max(w/iw,h/ih);
    const nw=iw*r, nh=ih*r;
    const ox=x+(w-nw)/2, oy=y+(h-nh)/2;
    ctx.globalAlpha=a;
    ctx.drawImage(vid,ox,oy,nw,nh);
    ctx.globalAlpha=1;
  }

  function animate(){
    ctx.fillStyle="rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    for(const c of cards){
      drawVideoCover(c.vid,c.x,c.y,c.w,c.h,0.35);
      c.x += c.vx;
      c.y += c.vy;
      if (c.x < -c.w/4 || c.x > canvas.width - c.w/2) c.vx *= -1;
      if (c.y < -c.h/4 || c.y > canvas.height - c.h/2) c.vy *= -1;
    }
    requestAnimationFrame(animate);
  }

  /* === Boot: Live camera only, preserving original flow === */
  (async function(){
    try {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: { ideal: "environment" } },
        audio: false
      });
      const v = document.createElement("video");
      v.srcObject = stream;
      v.muted = true;
      v.playsInline = true;
      v.autoplay = true;
      v.style.display = "none";
      document.body.appendChild(v);
      await v.play().catch(()=>{});

      // duplicate same feed across all cards for motion consistency
      initCards(Array(NUM_CARDS).fill(v));
      animate();
    } catch (err) {
      console.warn("⚠️ Camera access denied/unavailable:", err);
      ctx.fillStyle = "rgba(32,32,32,1)";
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = "white";
      ctx.font = "18px monospace";
      ctx.textAlign = "center";
      ctx.fillText("Camera access denied", canvas.width/2, canvas.height/2);
    }
  })();
  </script>
</body>
</html>
