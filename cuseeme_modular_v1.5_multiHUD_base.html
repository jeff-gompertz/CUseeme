<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CUSeeMe Modular v1.5 — Multi-HUD Base</title>
<link rel="stylesheet" href="css/shell_theme_cuseeme_classic_retro4.4.css" />

<style>
/* --- Shared HUD Fade Framework --- */
.hud-panel {
position:absolute; inset:0;
opacity:0; pointer-events:none;
transition:opacity .3s ease;
}
.hud-panel.active {
opacity:1; pointer-events:auto;
}

/* --- Mode>Shift header --- */
#hudHeader {
text-align:center;
font-family:"VT323", monospace;
font-size:1.4em;
color:var(--hud-gray);
cursor:pointer;
letter-spacing:1px;
user-select:none;
}
#hudHeader:hover {
color:var(--accent);
text-shadow:0 0 4px var(--accent);
}

/* --- HUD counter --- */
#hudIndex {
position:absolute;
top:4px; left:10px;
font-size:0.75em;
opacity:0.5;
color:var(--hud-gray);
font-family:"VT323", monospace;
}
</style>
</head>

<body>

<!-- [L0] MAIN CAMERA -->
<video id="cameraMain" autoplay muted playsinline></video>

<!-- [L1] HUD WRAPPER -->
<div id="hudWrapper">

<!-- HUD INDEX -->
<div id="hudIndex">HUD 1 / 3</div>

<!-- HEADER (Mode>Shift) -->
<div id="hudHeader">Mode &gt; Shift</div>

<!-- HUD 1 — Base Control -->
<div id="hud1" class="hud-panel active">
<div class="hud-row">
<button class="hud-btn active" id="btnNewWindow">➕ New Window</button>
<button class="hud-btn" id="btnReverseCam">🔁 Reverse Cam</button>
</div>
<div class="hud-row">
<button class="hud-btn" id="btnNewVideo">🎥 New Video</button>
<button class="hud-btn" id="btnVoice">🔊 Voice On</button>
</div>
<div class="hud-row">
<button class="hud-btn" id="btnReset">Reset</button>
</div>
</div>

<!-- HUD 2 — Placeholder -->
<div id="hud2" class="hud-panel">
<div class="hud-row"><button class="hud-btn">Spawn 6 Windows</button></div>
<div class="hud-row"><button class="hud-btn">Grid Mode</button></div>
<div class="hud-row"><button class="hud-btn">Close All</button></div>
</div>

<!-- HUD 3 — Placeholder -->
<div id="hud3" class="hud-panel">
<div class="hud-row"><button class="hud-btn">X Drift</button></div>
<div class="hud-row"><button class="hud-btn">Zoom</button></div>
<div class="hud-row"><button class="hud-btn">Mirror</button></div>
</div>

</div>

<!-- [L3] TICKER -->
<div id="ticker"></div>

<!-- [L4] PROMPT -->
<div id="promptWrap">
<div id="promptBox">
<input id="input" type="text" placeholder="type here…" spellcheck="false" autocomplete="off" />
</div>
</div>

<!-- [L5] MINI FEED -->
<div id="miniWin" aria-label="mini feed window">
<div id="miniBar">
<div id="miniTitle">subject_0001</div>
<div id="miniBtns"><div class="win-dot"></div><div class="win-dot"></div><div class="win-dot"></div></div>
</div>
<div id="miniInner"><video id="cameraMini" autoplay muted playsinline></video></div>
</div>

<script>
/* =========================================================
BASE SYSTEMS (ticker / camera / voice / input)
(identical to v1.4)
========================================================= */
const ticker=document.getElementById('ticker');
function addTicker(t){const l=document.createElement('div');l.className='tline';l.textContent=t;ticker.prepend(l);
if(ticker.children.length>80)ticker.removeChild(ticker.lastChild);
setTimeout(()=>l.style.opacity=.25,60000);}
['link /optical established','loopback handshake ok','field integrity 99.2%','ui shell ready','ticker: online']
.forEach((m,i)=>setTimeout(()=>addTicker(m),300*i));

const vMain=document.getElementById('cameraMain');
const vMini=document.getElementById('cameraMini');
(async()=>{try{
const s=await navigator.mediaDevices.getUserMedia({video:true,audio:false});
vMain.srcObject=s;vMini.srcObject=s;addTicker('camera stream: granted');
}catch(e){addTicker('⚠ camera denied');}})();

let voiceOn=true,voicesReady=false;
function primeVoices(){return new Promise(res=>{const id=setInterval(()=>{
const v=speechSynthesis.getVoices();if(v&&v.length){clearInterval(id);voicesReady=true;res();}},100);});}
speechSynthesis.onvoiceschanged=primeVoices;
async function speak(t){if(!voiceOn||!('speechSynthesis'in window))return;
if(!voicesReady)await primeVoices();const u=new SpeechSynthesisUtterance(t);
u.lang='en-US';u.rate=1.05;u.pitch=0.9;u.volume=0.85;
const v=speechSynthesis.getVoices();
u.voice=v.find(x=>/samantha/i.test(x.name))||v.find(x=>/google/i.test(x.name))||v[0];
speechSynthesis.speak(u);}
function unlockTTS(){try{speechSynthesis.speak(new SpeechSynthesisUtterance(''));speechSynthesis.cancel();}catch(e){}
window.removeEventListener('touchstart',unlockTTS);window.removeEventListener('click',unlockTTS);}
window.addEventListener('touchstart',unlockTTS,{once:true});
window.addEventListener('click',unlockTTS,{once:true});

/* =========================================================
MODE > SHIFT (HUD Swap Framework)
========================================================= */
const huds=[...document.querySelectorAll('.hud-panel')];
const hudIndex=document.getElementById('hudIndex');
let currentHUD=0;
document.getElementById('hudHeader').addEventListener('click',()=>{
huds[currentHUD].classList.remove('active');
currentHUD=(currentHUD+1)%huds.length;
huds[currentHUD].classList.add('active');
hudIndex.textContent=`HUD ${currentHUD+1} / ${huds.length}`;
addTicker(`HUD switched → ${currentHUD+1}`);
});
</script>
</body>
</html>
