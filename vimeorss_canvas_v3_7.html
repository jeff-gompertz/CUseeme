<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vimeo RSS Canvas v3.7</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
  }

  /* === VIMEO BACKGROUND === */
  #vimeo-bg {
    position: fixed;
    top: 0; left: 0;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    z-index: 0;
    background: #000;
  }

  #vimeo-bg iframe {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100vw;
    height: 56.25vw; /* 16:9 */
    min-width: 100%;
    min-height: 100%;
    transform: translate(-50%, -50%) scale(1.25);
    transform-origin: center;
    object-fit: cover;
    border: none;
    pointer-events: none;
    opacity: 0;
    transition: opacity 1.5s ease-in-out;
  }
  #vimeo-bg iframe.active { opacity: 1; }

  /* Vignette overlay */
  #vignette {
    position: fixed;
    inset: 0;
    background: radial-gradient(ellipse at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.4) 100%);
    z-index: 1;
    pointer-events: none;
  }

  /* === TEXT LAYER === */
  #ecran {
    position: relative;
    z-index: 2;
    width: 100%;
    height: 100vh;
    overflow: hidden;
    color: #fff;
    text-align: center;
    font-family: Arial, Helvetica, sans-serif;
    font-weight: bold;
    font-size: 10rem;
    line-height: 1.1;
  }

  #ecran-inner {
    height: 100%;
    width: 90%;
    margin: 0 auto;
    overflow-y: scroll;
    scrollbar-width: none;
    -ms-overflow-style: none;
    pointer-events: none;
  }
  #ecran-inner::-webkit-scrollbar { display: none; }

  /* === iOS Safari Fullscreen Fix === */
  @supports (-webkit-touch-callout: none) {
    #vimeo-bg iframe {
      width: 200vw !important;
      height: 200vh !important;
      top: 50% !important;
      left: 50% !important;
      transform: translate(-50%, -50%) scale(1.1) !important;
      object-fit: cover !important;
    }
    html, body {
      height: 100vh !important;
      overflow: hidden !important;
      background: #000 !important;
    }
  }
</style>
</head>

<body>
  <div id="vimeo-bg"></div>
  <div id="vignette"></div>

  <div id="ecran">
    <div id="ecran-inner">
      <script src="//rss.bloople.net/?url=https%3A%2F%2Frss.nytimes.com%2Fservices%2Fxml%2Frss%2Fnyt%2FHomePage.xml&showtitle=false&type=js"></script>
    </div>
  </div>

  <script>
  /* === Vimeo RSS loader === */
  (async () => {
    const container = document.getElementById('vimeo-bg');
    try {
      const res = await fetch('https://api.allorigins.win/raw?url=https://vimeo.com/channels/staffpicks/videos/rss');
      const text = await res.text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(text, 'text/xml');
      const items = [...xml.querySelectorAll('item')].slice(0, 4);

      const videos = items.map(item => {
        const link = item.querySelector('link')?.textContent;
        return link ? `https://player.vimeo.com/video/${link.split('/').pop()}?background=1&autoplay=1&muted=1&loop=1` : null;
      }).filter(Boolean);

      videos.forEach((src, i) => {
        const iframe = document.createElement('iframe');
        iframe.src = src;
        iframe.allow = 'autoplay; fullscreen';
        if (i === 0) iframe.classList.add('active');
        container.appendChild(iframe);
      });

      let index = 0;
      setInterval(() => {
        const iframes = container.querySelectorAll('iframe');
        iframes.forEach((f, i) => f.classList.toggle('active', i === index));
        index = (index + 1) % iframes.length;
      }, 15000);
    } catch (err) {
      console.warn('Vimeo RSS error:', err);
    }
  })();

  /* === NYT Auto-scroll === */
  function ScrollDiv() {
    const inner = document.getElementById('ecran-inner');
    if (!inner) return;
    if (inner.scrollTop < inner.scrollHeight - inner.offsetHeight) {
      inner.scrollTop += 1;
    } else {
      inner.scrollTop = 0;
    }
  }
  setInterval(ScrollDiv, 14);
  </script>
</body>
</html>
